VAR A 0
VAR B 0
VAR S1 0
VAR S2 0
VAR RETA 0
STR hello "I can compute n'th Fibonacci number. Which do you want?"
WRITESTR hello
READ A
PUSH A
CALL fib
POP A
STR answer "And the answer is: "
WRITESTR answer
WRITE A
STOP
:fib POP RETA
POP A
C2M 0 S1
EQ A S1
IF exit
C2M 1 S1
EQ A S1
IF exit
C2M -1 B
ADD A B
PUSH RETA
PUSH A
PUSH A
CALL fib
POP S1
POP A
C2M -1 B
ADD A B
PUSH S1
PUSH A
CALL fib
POP S2
POP S1
POP RETA
ADD S1 S2
:exit PUSH S1
M2M RETA IP